app2Dir
before2000Secs
listStatus
 Now,lets change the confs
conf
suffix
when
mockfs://foo/
getRawFileSystem
 Set time last modified of app1Dir directory and its files to before2000Secs
fs.mockfs.impl
Assert
rootFs
me
application_1_1
application_1_2
50
logs
app1Dir
init
 We have not called refreshLogSettings,hence don't expect to see the changed conf values
thenReturn
app2DirStatus
rootPath
getFileSystem
 time before 2000 sec
remoteRootLogDir
1
app2Log1
2
app1DirStatus
userDirStatus
stop
true
mockFs
app1Log1
refreshLogRetentionSettings
before50Secs
remoteRootLogPath
app1Log1Status
app2Log1Status
delete
System
timeout
 app1Dir would be deleted since its done above log retention period
tmp/logs
times
 app2Dir is not expected to be deleted since its below the threshold
createConf
YarnConfiguration
assertTrue
getCheckIntervalMsecs
now
root
 Set time last modified of app1Dir directory and its files to before50Secs
verify
testRefreshLogRetentionSettings
set
host1
deletionSvc
setClass
start
1800
 time before 50 sec
currentTimeMillis
userDir
 refresh the log settings
 Check interval time should reflect the new value
 app2Dir should be deleted since it falls above the threshold
userLogDir
