00
reader
 Make an index entry for every third insertion.
FIRST_KEY
conf
 less than first key in the mapfile, that the first key is returned.
FileSystem
90
 Get closest that falls before the passed key: 50
 the first key in the file, we should get null
50
TEST_DIR
testGetClosest.mapfile
55
 Assert that closest after 55 is 60
99
LOG
 Assert that null is returned if key is > last entry in mapfile.
deprecation
TWENTY
getIndexInterval
testGetClosest
qualifiedDirName
 Test get closest when we pass explicit key
iStr
60
 Now do getClosest on created mapfile.
20
dirName
 Write a mapfile of simple data: keys are
 Add entries up to 100 in intervals of ten.
MapFile
fs
cleanupWithLogger
substring
getClosest
 If we were looking for the key before, we should get the last key
close
value
key
 Assert that the index interval is 1
length
assertEquals
Integer
parseInt
IOUtils
setIndexInterval
assertNull
t
getLocal
makeQualified
toString
writer
append
closest
